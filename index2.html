<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MapReduce â€“ File Upload Version</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white p-8">

  <div class="max-w-3xl mx-auto space-y-6">

    <h1 class="text-3xl font-bold text-center mb-6">MapReduce Word Counter (Upload Files)    <a href="index.html" class="border border-red-500 p-3 rounded bg-yellow-900">Text Inputs</a></h1>

    <!-- File Upload -->
    <div>
      <label class="font-semibold">Upload First Text File</label>
      <input id="file1" type="file" accept=".txt" class="block w-full mt-2 p-2 bg-gray-800 rounded" onchange="handleFile1(event)" />
    </div>

    <div>
      <label class="font-semibold">Upload Second Text File</label>
      <input id="file2" type="file" accept=".txt" class="block w-full mt-2 p-2 bg-gray-800 rounded" onchange="handleFile2(event)" />
    </div>

    <!-- Process Button -->
    <button id="processUploadBtn"
      class="w-full py-3 bg-green-600 hover:bg-green-700 rounded text-lg font-semibold">
      Run MapReduce on Uploaded Files
    </button>

    <!-- Output -->
    <h2 class="text-xl font-semibold">Output:</h2>
    <pre id="uploadOutput"
      class="bg-gray-800 p-4 rounded min-h-[120px] whitespace-pre-wrap"></pre>

  </div>

  <script>
    // Variables to hold uploaded files
    let uploadFile1 = null;
    let uploadFile2 = null;

    // Handle file input changes
    function handleFile1(event) {
        uploadFile1 = event.target.files[0];
    }

    function handleFile2(event) {
        uploadFile2 = event.target.files[0];
    }

    // MapReduce function for file uploads
    function mapReduceFileUploads(text) {
        const words = text.toLowerCase().match(/\b[a-z0-9]+\b/g) || [];
        const counters = {};

        words.forEach(word => {
            counters[word] = (counters[word] || 0) + 1;
        });

        let result = "Word Count Result (Uploaded Files):\n\n";
        for (let w in counters) {
            result += `${w}: ${counters[w]}\n`;
        }
        return result;
    }

    // Event listener for the process button
    const processUploadBtn = document.getElementById("processUploadBtn");

    if (processUploadBtn) {
        processUploadBtn.addEventListener("click", async () => {
            if (!uploadFile1 || !uploadFile2) {
                document.getElementById("uploadOutput").textContent =
                    "Please upload both files before processing.";
                return;
            }

            const text1 = await uploadFile1.text();
            const text2 = await uploadFile2.text();

            const finalText = text1 + " " + text2;

            document.getElementById("uploadOutput").textContent =
                mapReduceFileUploads(finalText);
        });
    }
  </script>

</body>
</html>
